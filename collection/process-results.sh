#!/bin/bash
N=${1:-10000}
LATENCY_RESULTS=${2:-latency-results.csv}
METRIC_RESULTS=${3:-metric-results.csv}
STATS_RESULTS=${4:-stats-results.csv}
DIR=${5:-results}
LOGS_DIR=${6:-results-logs}
LATENCY_FILES=${7:-"$DIR/multi-oci-election.csv $DIR/multi-pod-election.csv $DIR/single-mmap-election.csv $DIR/single-oci-election.csv $DIR/single-pod-election.csv $DIR/wob-full-election.csv $DIR/wob-original-election.csv $DIR/wob-partial-election.csv $DIR/multi-oci-feature.csv $DIR/multi-pod-feature.csv $DIR/single-mmap-feature.csv $DIR/single-oci-feature.csv $DIR/single-pod-feature.csv $DIR/wob-full-feature.csv $DIR/wob-original-feature.csv $DIR/wob-partial-feature.csv $DIR/multi-oci-hotel.csv $DIR/multi-pod-hotel.csv $DIR/single-mmap-hotel.csv $DIR/single-oci-hotel.csv $DIR/single-pod-hotel.csv $DIR/wob-full-hotel.csv $DIR/wob-original-hotel.csv $DIR/wob-partial-hotel.csv $DIR/multi-oci-pipelined.csv $DIR/multi-pod-pipelined.csv $DIR/single-mmap-pipelined.csv $DIR/single-oci-pipelined.csv $DIR/single-pod-pipelined.csv $DIR/wob-full-pipelined.csv $DIR/wob-original-pipelined.csv $DIR/wob-partial-pipelined.csv $DIR/multi-oci-sentiment.csv $DIR/multi-pod-sentiment.csv $DIR/single-mmap-sentiment.csv $DIR/single-oci-sentiment.csv $DIR/single-pod-sentiment.csv $DIR/wob-full-sentiment.csv $DIR/wob-original-sentiment.csv $DIR/wob-partial-sentiment.csv $DIR/multi-oci-video.csv $DIR/multi-pod-video.csv $DIR/single-mmap-video.csv $DIR/single-oci-video.csv $DIR/single-pod-video.csv $DIR/wob-full-video.csv $DIR/wob-original-video.csv $DIR/wob-partial-video.csv $DIR/multi-oci-wage.csv $DIR/multi-pod-wage.csv $DIR/single-mmap-wage.csv $DIR/single-oci-wage.csv $DIR/single-pod-wage.csv $DIR/wob-full-wage.csv $DIR/wob-original-wage.csv $DIR/wob-partial-wage.csv"}
LOG_FILES=${8:-"election-gateway election-get-results election-vote-enqueuer election-vote-processor feature-extractor feature-orchestrator feature-reducer feature-status feature-wait hotel-frontend hotel-geo hotel-profile hotel-rate hotel-recommend hotel-reserve hotel-search hotel-user pipelined-checksum pipelined-encrypt pipelined-main pipelined-zip sentiment-cfail sentiment-db sentiment-main sentiment-product-or-service sentiment-product-result sentiment-product-sentiment sentiment-read-csv sentiment-service-result sentiment-service-sentiment sentiment-sfail sentiment-sns video-decoder video-recog video-streaming wage-avg wage-format wage-merit wage-stats wage-sum wage-validator wage-write-merit wage-write-raw election-single feature-single hotel-single pipelined-single sentiment-single video-single wage-single election-full feature-full hotel-full pipelined-full sentiment-full video-full wage-full"}
METRIC_FILES=${9:-"$DIR/node1-metrics.csv $DIR/node2-metrics.csv $DIR/node3-metrics.csv $DIR/node4-metrics.csv $DIR/node5-metrics.csv"}
mkdir $LOGS_DIR
go run ../tools/processing-scripts/process-latency.go $N $LATENCY_RESULTS $LATENCY_FILES
go run ../tools/processing-scripts/clean-logs.go $DIR $LOGS_DIR $LOG_FILES
go run ../tools/processing-scripts/process-metrics.go $METRIC_RESULTS $METRIC_FILES

go run ../tools/processing-scripts/process-logs.go "0:5:1,0:6:1,0:10:1,0:11:1,1:5:4,1:6:4,1:10:4,1:11:4,1:7:4,0:12:1,2:5:1,2:6:1,2:10:1,2:11:1,3:5:1,3:6:1,3:10:1,3:11:1,4:5:1,4:6:1,4:10:1,4:11:1,4:7:1,3:7:1,2:12:1,2:7:1,0:7:1" $LOGS_DIR multi-oci-feature-processed-log.csv multi-oci-feature orchestrator extractor wait status reducer
go run ../tools/processing-scripts/process-logs.go "0:3:1,0:13:1,1:6:4,1:7:4,1:12:4,0:14:1,0:13:1,2:6:1,2:7:1,2:13:1,3:6:1,3:7:1,3:13:1,4:6:1,4:7:1,4:12:1,3:14:1,3:12:1,2:14:1,2:12:1,0:14:1,0:4:1" $LOGS_DIR multi-pod-feature-processed-log.csv multi-pod-feature orchestrator extractor wait status reducer
go run ../tools/processing-scripts/process-logs.go "0:3:1,0:4:1" $LOGS_DIR single-mmap-feature-processed-log.csv single-mmap-feature single-mmap
go run ../tools/processing-scripts/process-logs.go "0:5:1,0:6:1,0:7:1" $LOGS_DIR single-oci-feature-processed-log.csv single-oci-feature single-oci
go run ../tools/processing-scripts/process-logs.go "0:3:1,0:4:1" $LOGS_DIR single-pod-feature-processed-log.csv single-pod-feature single-pod
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:1:1" $LOGS_DIR wob-full-feature-processed-log.csv wob-full-feature-feature full
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:1:1,1:0:4,1:1:4,0:2:1,0:3:1,2:0:1,2:1:1,3:0:1,3:1:1,4:0:1,4:1:1,3:2:1,2:2:1,0:4:1" $LOGS_DIR wob-original-feature-processed-log.csv wob-original-feature-feature orchestrator extractor wait status reducer
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:1:1,1:0:4,1:1:4,0:2:1,0:3:1" $LOGS_DIR wob-partial-feature-processed-log.csv wob-partial-feature-feature orchestrator-wsr extractor-partial

go run ../tools/processing-scripts/process-logs.go "0:0:1,0:2:1,0:3:1,1:0:1,1:2:1,1:3:1,2:0:1,2:2:1,2:3:1,2:1:1,1:4:1,1:5:1,3:0:1,3:2:1,3:3:1,3:1:1,1:6:1,1:7:1,1:1:1,0:4:1,0:5:1,0:1:1" $LOGS_DIR multi-oci-hotel-processed-log.csv multi-oci-hotel frontend search geo rate profile recommend reserve user
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:1:1,0:11:1,1:5:1,1:6:1,1:11:1,2:5:1,2:6:1,2:10:1,1:12:1,1:11:1,3:5:1,3:6:1,3:10:1,1:12:1,1:10:1,0:12:1,0:2:1" $LOGS_DIR multi-pod-hotel-processed-log.csv multi-pod-hotel frontend search geo rate profile recommend reserve user
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:1:1,0:2:1" $LOGS_DIR single-mmap-hotel-processed-log.csv single-mmap-hotel single-mmap
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:1:1" $LOGS_DIR single-oci-hotel-processed-log.csv single-oci-hotel single-oci
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:1:1,0:2:1" $LOGS_DIR single-pod-hotel-processed-log.csv single-pod-hotel single-pod
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:1:1" $LOGS_DIR wob-full-hotel-processed-log.csv wob-full-hotel-hotel full
go run ../tools/processing-scripts/process-logs.go "0:0:1,1:0:1,1:1:1,2:0:1,2:1:1,1:2:1,1:3:1,3:0:1,3:1:1,1:4:1,1:5:1,0:1:1" $LOGS_DIR wob-original-hotel-processed-log.csv wob-original-hotel-hotel frontend search geo rate profile recommend reserve user
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:3:1" $LOGS_DIR wob-partial-hotel-processed-log.csv wob-partial-hotel-hotel frontend-spgr recommend-partial reserve-partial user-partial

go run ../tools/processing-scripts/process-logs.go "0:5:1,0:6:1,0:10:1,0:11:1,1:5:1,1:6:1,1:10:1,1:11:1,2:5:1,2:6:1,2:10:1,2:11:1,4:5:1,4:6:1,4:10:1,4:11:1,5:5:1,5:6:1,5:10:1,5:13:1,7:5:1,7:6:1,7:10:1,7:11:1,8:5:1,8:6:1,8:10:1,8:11:1,8:7:1,7:12:1,7:7:1,5:14:1,5:7:1,4:12:1,4:7:1,2:12:1,2:7:1,1:12:1,1:7:1,0:12:1,0:7:1" $LOGS_DIR multi-oci-sentiment-processed-log.csv multi-oci-sentiment main read-csv product-or-service cfail product-sentiment product-result sfail sns db service-sentiment service-result
go run ../tools/processing-scripts/process-logs.go "0:3:1,0:13:1,1:6:1,1:7:1,1:13:1,2:6:1,2:7:1,2:13:1,4:6:1,4:7:1,4:13:1,5:6:1,5:7:1,5:13:1,7:6:1,7:7:1,7:13:1,8:6:1,8:7:1,8:12:1,7:14:1,7:12:1,5:14:1,5:12:1,4:14:1,4:12:1,2:14:1,2:12:1,1:14:1,1:12:1,0:14:1,0:4:1" $LOGS_DIR multi-pod-sentiment-processed-log.csv multi-pod-sentiment main read-csv product-or-service cfail product-sentiment product-result sfail sns db service-sentiment service-result
go run ../tools/processing-scripts/process-logs.go "0:3:1,0:4:1" $LOGS_DIR single-mmap-sentiment-processed-log.csv single-mmap-sentiment single-mmap
go run ../tools/processing-scripts/process-logs.go "0:5:1,0:6:1,0:7:1" $LOGS_DIR single-oci-sentiment-processed-log.csv single-oci-sentiment single-oci
go run ../tools/processing-scripts/process-logs.go "0:3:1,0:4:1" $LOGS_DIR single-pod-sentiment-processed-log.csv single-pod-sentiment single-pod
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:1:1" $LOGS_DIR wob-full-sentiment-processed-log.csv wob-full-sentiment-sentiment full
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:1:1,1:0:1,1:1:1,2:0:1,2:1:1,4:0:1,4:1:1,5:0:1,5:3:1,7:0:1,7:1:1,8:0:1,8:1:1,7:2:1,5:4:1,5:7:1,4:2:1,2:2:1,2:7:1,1:2:1,0:2:1" $LOGS_DIR wob-original-sentiment-processed-log.csv wob-original-sentiment-sentiment main read-csv product-or-service cfail product-sentiment product-result sfail sns db service-sentiment service-result
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:1:1,1:0:1,1:1:1,3:0:1,3:1:1,1:2:1,0:2:1,0:5:1" $LOGS_DIR wob-partial-sentiment-processed-log.csv wob-partial-sentiment-sentiment main-rcposc product-sentiment-prs service-sentiment-srs db-s

go run ../tools/processing-scripts/process-logs.go "0:5:1,0:6:1,0:10:1,0:11:1,1:5:1,1:6:1,1:10:1,1:11:1,2:5:6,2:6:6,2:10:6,2:11:6,2:7:6,1:12:!,1:13:1,1:7:1,0:12:1,0:7:1" $LOGS_DIR multi-oci-video-processed-log.csv multi-oci-video streaming decoder recog
go run ../tools/processing-scripts/process-logs.go "0:3:1,0:13:1,1:6:1,1:7:1,1:13:1,2:6:6,2:7:6,2:12:6,1:14:1,1:12:1,0:14:1,0:4:1" $LOGS_DIR multi-pod-video-processed-log.csv multi-pod-video streaming decoder recog
go run ../tools/processing-scripts/process-logs.go "0:3:1,0:4:1" $LOGS_DIR single-mmap-video-processed-log.csv single-mmap-video single-mmap
go run ../tools/processing-scripts/process-logs.go "0:5:1,0:6:1,0:7:1" $LOGS_DIR single-oci-video-processed-log.csv single-oci-video single-oci
go run ../tools/processing-scripts/process-logs.go "0:3:1,0:4:1" $LOGS_DIR single-pod-video-processed-log.csv single-pod-video single-pod
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:1:1" $LOGS_DIR wob-full-video-processed-log.csv wob-full-video-video full
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:1:1,1:0:1,1:1:1,2:0:6,2:1:6,1:2:1,1:3:1,0:2:1" $LOGS_DIR wob-original-video-processed-log.csv wob-original-video-video streaming decoder recog
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:1:1,1:0:6,1:1:6,0:2:1,0:3:1" $LOGS_DIR wob-partial-video-processed-log.csv wob-partial-video-video streaming-d recog-partial

go run ../tools/processing-scripts/process-logs.go "0:5:1,0:6:1,0:10:1,0:17:1,1:5:1,1:6:1,1:10:1,1:11:1,2:5:1,2:6:1,2:10:1,2:11:1,3:5:1,3:6:1,3:10:1,3:11:1,4:5:100,4:6:100,4:10:100,4:11:100,5:5:100,5:6:100,5:10:100,5:11:100,6:5:100,6:6:100,6:10:100,6:11:100,7:5:100,7:6:100,7:10:100,7:11:100,7:7:100,6:12:100,6:7:100,5:12:100,5:7:100,4:12:100,4:7:100,3:12:1,3:7:1,2:12:1,2:7:1,1:12:1,1:7:1,0:18:1,0:7:1" $LOGS_DIR multi-oci-wage-processed-log.csv multi-oci-wage validator format write-raw stats sum avg merit write-merit
go run ../tools/processing-scripts/process-logs.go "0:3:1,0:13:1,1:6:1,1:7:1,1:13:1,2:6:1,2:7:1,2:13:1,3:6:1,3:7:1,3:13:1,4:6:100,4:7:100,4:13:100,5:6:100,5:7:100,5:13:100,6:6:100,6:7:100,6:13:100,7:6:100,7:7:100,7:12:100,6:14:100,6:12:100,5:14:100,5:12:100,4:14:100,4:12:100:10,3:14:1,3:12:1,2:14:1,2:12:1,1:14:1,1:12:1,0:14:1,0:4:1" $LOGS_DIR multi-pod-wage-processed-log.csv multi-pod-wage validator format write-raw stats sum avg merit write-merit
go run ../tools/processing-scripts/process-logs.go "0:3:1,0:4:1" $LOGS_DIR single-mmap-wage-processed-log.csv single-mmap-wage single-mmap
go run ../tools/processing-scripts/process-logs.go "0:5:1,0:6:1,0:7:1" $LOGS_DIR single-oci-wage-processed-log.csv single-oci-wage single-oci
go run ../tools/processing-scripts/process-logs.go "0:3:1,0:4:1" $LOGS_DIR single-pod-wage-processed-log.csv single-pod-wage single-pod
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:1:1" $LOGS_DIR wob-full-wage-processed-log.csv wob-full-wage-wage full
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:7:1,1:0:1,1:1:1,2:0:1,2:1:1,3:0:1,3:1:1,4:0:100,4:1:100,5:0:100,5:1:100,6:0:100,6:1:100,7:0:100,7:1:100,6:2:100,5:2:100,4:2:100,3:2:1,2:2:1,1:2:1,0:8:1" $LOGS_DIR wob-original-wage-processed-log.csv wob-original-wage-wage validator format write-raw stats sum avg merit write-merit
go run ../tools/processing-scripts/process-logs.go "0:0:1,0:7:1,1:0:1,1:1:1,2:0:100,2:1:100,1:2:1,0:8:1,0:9:1" $LOGS_DIR wob-partial-wage-processed-log.csv wob-partial-wage-wage validator-fw stats-partial sum-amw

#go run ../tools/processing-scripts/process-logs.go "TODO" $LOGS_DIR multi-oci-election-processed-log.csv multi-oci-election gateway get-results vote-enqueuer vote-processor
#go run ../tools/processing-scripts/process-logs.go "TODO" $LOGS_DIR multi-pod-election-processed-log.csv multi-pod-election gateway get-results vote-enqueuer vote-processor
#go run ../tools/processing-scripts/process-logs.go "TODO" $LOGS_DIR single-mmap-election-processed-log.csv single-mmap-election single-mmap
#go run ../tools/processing-scripts/process-logs.go "TODO" $LOGS_DIR single-oci-election-processed-log.csv single-oci-election single-oci
#go run ../tools/processing-scripts/process-logs.go "TODO" $LOGS_DIR single-pod-election-processed-log.csv single-pod-election single-pod
#go run ../tools/processing-scripts/process-logs.go "TODO" $LOGS_DIR wob-full-election-processed-log.csv wob-full-election-election full
#go run ../tools/processing-scripts/process-logs.go "TODO" $LOGS_DIR wob-original-election-processed-log.csv wob-original-election-election gateway get-results vote-enqueuer vote-processor
#go run ../tools/processing-scripts/process-logs.go "TODO" $LOGS_DIR wob-partial-election-processed-log.csv wob-partial-election-election gateway-vevp get-results-partial

#go run ../tools/processing-scripts/process-logs.go "TODO" $LOGS_DIR multi-oci-pipelined-processed-log.csv multi-oci-pipelined main checksum zip encrypt
#go run ../tools/processing-scripts/process-logs.go "TODO" $LOGS_DIR multi-pod-pipelined-processed-log.csv multi-pod-pipelined main checksum zip encrypt
#go run ../tools/processing-scripts/process-logs.go "TODO" $LOGS_DIR single-mmap-pipelined-processed-log.csv single-mmap-pipelined single-mmap
#go run ../tools/processing-scripts/process-logs.go "TODO" $LOGS_DIR single-oci-pipelined-processed-log.csv single-oci-pipelined single-oci
#go run ../tools/processing-scripts/process-logs.go "TODO" $LOGS_DIR single-pod-pipelined-processed-log.csv single-pod-pipelined single-pod
#go run ../tools/processing-scripts/process-logs.go "TODO" $LOGS_DIR wob-full-pipelined-processed-log.csv wob-full-pipelined-pipelined full
#go run ../tools/processing-scripts/process-logs.go "TODO" $LOGS_DIR wob-original-pipelined-processed-log.csv wob-original-pipelined-pipelined main checksum zip encrypt
#go run ../tools/processing-scripts/process-logs.go "TODO" $LOGS_DIR wob-partial-pipelined-processed-log.csv wob-partial-pipelined-pipelined main-partial checksum-partial zip-partial encrypt-partial

#"multi-oci-election;multi-oci-election-processed-log.csv" "multi-pod-election;multi-pod-election-processed-log.csv" "single-mmap-election;single-mmap-election-processed-log.csv" "single-oci-election;single-oci-election-processed-log.csv" "single-pod-election;single-pod-election-processed-log.csv" "wob-full-election;wob-full-election-processed-log.csv" "wob-original-election;wob-original-election-processed-log.csv" "wob-partial-election;wob-partial-election-processed-log.csv" "multi-oci-pipelined;multi-oci-pipelined-processed-log.csv" "multi-pod-pipelined;multi-pod-pipelined-processed-log.csv" "single-mmap-pipelined;single-mmap-pipelined-processed-log.csv" "single-oci-pipelined;single-oci-pipelined-processed-log.csv" "single-pod-pipelined;single-pod-pipelined-processed-log.csv" "wob-full-pipelined;wob-full-pipelined-processed-log.csv" "wob-original-pipelined;wob-original-pipelined-processed-log.csv" "wob-partial-pipelined;wob-partial-pipelined-processed-log.csv"

go run ../tools/processing-scripts/process-stats.go $STATS_RESULTS $LATENCY_RESULTS $METRIC_RESULTS "multi-oci-feature;multi-oci-feature-processed-log.csv" "multi-pod-feature;multi-pod-feature-processed-log.csv" "single-mmap-feature;single-mmap-feature-processed-log.csv" "single-oci-feature;single-oci-feature-processed-log.csv" "single-pod-feature;single-pod-feature-processed-log.csv" "wob-full-feature;wob-full-feature-processed-log.csv" "wob-original-feature;wob-original-feature-processed-log.csv" "wob-partial-feature;wob-partial-feature-processed-log.csv" "multi-oci-hotel;multi-oci-hotel-processed-log.csv" "multi-pod-hotel;multi-pod-hotel-processed-log.csv" "single-mmap-hotel;single-mmap-hotel-processed-log.csv" "single-oci-hotel;single-oci-hotel-processed-log.csv" "single-pod-hotel;single-pod-hotel-processed-log.csv" "wob-full-hotel;wob-full-hotel-processed-log.csv" "wob-original-hotel;wob-original-hotel-processed-log.csv" "wob-partial-hotel;wob-partial-hotel-processed-log.csv" "multi-oci-sentiment;multi-oci-sentiment-processed-log.csv" "multi-pod-sentiment;multi-pod-sentiment-processed-log.csv" "single-mmap-sentiment;single-mmap-sentiment-processed-log.csv" "single-oci-sentiment;single-oci-sentiment-processed-log.csv" "single-pod-sentiment;single-pod-sentiment-processed-log.csv" "wob-full-sentiment;wob-full-sentiment-processed-log.csv" "wob-original-sentiment;wob-original-sentiment-processed-log.csv" "wob-partial-sentiment;wob-partial-sentiment-processed-log.csv" "multi-oci-video;multi-oci-video-processed-log.csv" "multi-pod-video;multi-pod-video-processed-log.csv" "single-mmap-video;single-mmap-video-processed-log.csv" "single-oci-video;single-oci-video-processed-log.csv" "single-pod-video;single-pod-video-processed-log.csv" "wob-full-video;wob-full-video-processed-log.csv" "wob-original-video;wob-original-video-processed-log.csv" "wob-partial-video;wob-partial-video-processed-log.csv" "multi-oci-wage;multi-oci-wage-processed-log.csv" "multi-pod-wage;multi-pod-wage-processed-log.csv" "single-mmap-wage;single-mmap-wage-processed-log.csv" "single-oci-wage;single-oci-wage-processed-log.csv" "single-pod-wage;single-pod-wage-processed-log.csv" "wob-full-wage;wob-full-wage-processed-log.csv" "wob-original-wage;wob-original-wage-processed-log.csv" "wob-partial-wage;wob-partial-wage-processed-log.csv"
